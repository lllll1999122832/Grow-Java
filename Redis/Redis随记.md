# 1. Redis CAP

Redis的CAP模型满足一致性（Consistency）和可用性（Availability）。这是因为Redis是一个分布式键值存储系统，它主要关注性能和速度。为了实现高吞吐量和低延迟，Redis在设计上做出了一些权衡，牺牲了一致性来换取更高的可用性。

在CAP模型中，一致性指的是所有节点在同一时间看到相同的数据。可用性指的是系统能够在正常情况下提供服务，即响应客户端的请求。

由于Redis是单主节点架构，即只有一个主节点负责写入和读取数据，而从节点只负责复制主节点的数据。当主节点发生故障时，从节点可以被选举为新的主节点，以保证系统的可用性。这种设计使得Redis能够在面对部分节点故障的情况下继续提供服务。

然而，Redis在追求可用性的同时，牺牲了一致性。当主节点发生故障并且从节点被选举为新的主节点时，可能会存在数据丢失或者数据不一致的情况。这是因为Redis采用了异步复制的方式来复制数据到从节点，因此在主节点发生故障之前未能完全复制到从节点的数据可能会丢失。

因此，Redis满足了一致性和可用性中的可用性，但在一致性方面做出了一定的牺牲。

---

# 2. PSYNC命令

PSYNC是一种用于Redis主从复制的同步命令。它的命令格式是：PSYNC <runid> <offset>。其中，runid是主服务器的ID，offset是从服务器最后接收命令的偏移量。这个命令用于在从服务器和主服务器之间进行数据同步。当从服务器连接到主服务器时，主服务器会将自己的runid和当前的复制偏移量发送给从服务器，从服务器会使用这些信息来进行数据同步。如果从服务器之前没有保存主服务器的runid，那么PSYNC命令会使用"PSYNC ? -1"的形式发送给主服务器，表示需要进行全量复制。

---

